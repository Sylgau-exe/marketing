<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MarketSim Live ‚Äî Marketing Simulation</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e1a;--card:#111827;--border:#1e293b;--primary:#3b82f6;--primary-hover:#2563eb;--accent:#8b5cf6;--green:#10b981;--red:#ef4444;--yellow:#f59e0b;--text:#e2e8f0;--muted:#94a3b8;--surface:#1e293b}
body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
a{color:var(--primary);text-decoration:none}
button{cursor:pointer;font-family:inherit}
.btn{padding:10px 24px;border-radius:8px;border:none;font-weight:600;font-size:.95rem;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 20px rgba(59,130,246,.3)}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text)}
.btn-outline:hover{border-color:var(--primary);background:rgba(59,130,246,.1)}
.btn-lg{padding:14px 32px;font-size:1.1rem}

/* Nav */
nav{display:flex;justify-content:space-between;align-items:center;padding:16px 40px;border-bottom:1px solid var(--border);background:rgba(10,14,26,.9);backdrop-filter:blur(10px);position:fixed;top:0;left:0;right:0;z-index:100}
.logo{font-size:1.4rem;font-weight:700;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.nav-links{display:flex;gap:12px;align-items:center}
.nav-user{display:flex;align-items:center;gap:10px;color:var(--muted)}

/* Hero */
.hero{padding:140px 40px 80px;text-align:center;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:800px;height:800px;background:radial-gradient(circle,rgba(59,130,246,.08) 0%,transparent 70%);pointer-events:none}
.hero h1{font-size:3.5rem;font-weight:800;line-height:1.15;margin-bottom:20px;max-width:800px;margin-left:auto;margin-right:auto}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{font-size:1.2rem;color:var(--muted);max-width:600px;margin:0 auto 32px;line-height:1.6}
.hero-actions{display:flex;gap:16px;justify-content:center;flex-wrap:wrap}

/* Features */
.features{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;padding:60px 40px;max-width:1200px;margin:0 auto}
.feature-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:32px;transition:all .3s}
.feature-card:hover{border-color:var(--primary);transform:translateY(-4px);box-shadow:0 8px 30px rgba(59,130,246,.1)}
.feature-icon{font-size:2rem;margin-bottom:12px}
.feature-card h3{font-size:1.15rem;margin-bottom:8px}
.feature-card p{color:var(--muted);font-size:.9rem;line-height:1.5}

/* How it works */
.how-section{padding:60px 40px;max-width:1000px;margin:0 auto;text-align:center}
.how-section h2{font-size:2rem;margin-bottom:40px}
.steps{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:32px}
.step{text-align:center}
.step-num{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.2rem;margin:0 auto 12px}
.step h4{margin-bottom:6px}
.step p{color:var(--muted);font-size:.85rem}

/* Segments Preview */
.segments{padding:60px 40px;max-width:1100px;margin:0 auto}
.segments h2{text-align:center;font-size:2rem;margin-bottom:32px}
.seg-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:16px}
.seg-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:20px;text-align:center}
.seg-emoji{font-size:2.5rem;margin-bottom:8px}
.seg-card h4{margin-bottom:4px;font-size:.95rem}
.seg-card p{color:var(--muted);font-size:.78rem}

/* Footer */
footer{text-align:center;padding:40px;color:var(--muted);font-size:.85rem;border-top:1px solid var(--border);margin-top:60px}

/* Modal */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:200;align-items:center;justify-content:center}
.modal-overlay.active{display:flex}
.modal{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:32px;width:420px;max-width:90vw;max-height:90vh;overflow-y:auto}
.modal h2{font-size:1.4rem;margin-bottom:20px;text-align:center}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:6px}
.form-group input,.form-group select{width:100%;padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:.95rem}
.form-group input:focus,.form-group select:focus{outline:none;border-color:var(--primary)}
.form-error{color:var(--red);font-size:.8rem;margin-top:4px;display:none}
.modal-footer{display:flex;justify-content:space-between;align-items:center;margin-top:20px}
.modal-footer a{font-size:.85rem}
.divider{text-align:center;color:var(--muted);margin:16px 0;position:relative}
.divider::before,.divider::after{content:'';position:absolute;top:50%;width:40%;height:1px;background:var(--border)}
.divider::before{left:0}.divider::after{right:0}
.btn-google{width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:.95rem;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-google:hover{background:rgba(255,255,255,.05);border-color:var(--muted)}
.alert{padding:10px 14px;border-radius:8px;font-size:.85rem;margin-bottom:16px;display:none}
.alert-error{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);color:var(--red)}
.alert-success{background:rgba(16,185,129,.1);border:1px solid rgba(16,185,129,.3);color:var(--green)}

/* Join Game Modal */
.join-input{display:flex;gap:8px}
.join-input input{flex:1}

@media(max-width:768px){
  .hero h1{font-size:2.2rem}
  nav{padding:12px 20px}
  .features,.segments,.how-section{padding:40px 20px}
  .seg-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>

<nav>
  <div class="logo">üéØ MarketSim</div>
  <div class="nav-links" id="navLinks">
    <button class="btn btn-outline" onclick="showModal('login')">Log In</button>
    <button class="btn btn-primary" onclick="showModal('register')">Sign Up</button>
  </div>
  <div class="nav-user" id="navUser" style="display:none">
    <span id="navUserName"></span>
    <button class="btn btn-outline" onclick="goToDashboard()">Dashboard</button>
    <button class="btn btn-outline" onclick="logout()">Logout</button>
  </div>
</nav>

<section class="hero">
  <h1>Master Marketing Strategy in a <span>Live Competitive Simulation</span></h1>
  <p>Lead a tech startup across global markets. Design products, set prices, run ad campaigns, and outperform rival teams ‚Äî all in real time.</p>
  <div class="hero-actions">
    <button class="btn btn-primary btn-lg" onclick="showModal('register')">Get Started Free</button>
    <button class="btn btn-outline btn-lg" onclick="showModal('join')">Join a Game</button>
  </div>
</section>

<section class="features">
  <div class="feature-card">
    <div class="feature-icon">üéØ</div>
    <h3>5 Market Segments</h3>
    <p>Target diverse customer segments ‚Äî from budget buyers to hardcore gamers ‚Äî across LATAM, Europe, and APAC regions.</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">üî¨</div>
    <h3>Brand Design & R&D</h3>
    <p>Engineer products with 8 component dimensions. Invest in R&D to unlock premium features and gain competitive advantage.</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">üìä</div>
    <h3>Balanced Scorecard</h3>
    <p>Performance measured across Financial, Market, Marketing Effectiveness, Investment, and Wealth Creation ‚Äî just like real business.</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">üì£</div>
    <h3>Full Marketing Mix</h3>
    <p>Control pricing, advertising, sales force, distribution channels, and internet marketing across three global regions.</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">üèÜ</div>
    <h3>Compete Live</h3>
    <p>Teams of 3-5 compete head-to-head over 8 quarterly rounds. Every decision counts in this dynamic market.</p>
  </div>
  <div class="feature-card">
    <div class="feature-icon">üéì</div>
    <h3>Instructor Tools</h3>
    <p>Create games, manage teams, advance quarters, coaching assistant, detailed analytics, and automated grading.</p>
  </div>
</section>

<section class="how-section">
  <h2>How It Works</h2>
  <div class="steps">
    <div class="step"><div class="step-num">1</div><h4>Create or Join</h4><p>Instructors create games, students join with a code</p></div>
    <div class="step"><div class="step-num">2</div><h4>Form Teams</h4><p>Teams of 3-5 members divide marketing responsibilities</p></div>
    <div class="step"><div class="step-num">3</div><h4>Make Decisions</h4><p>Design brands, set prices, allocate budgets each quarter</p></div>
    <div class="step"><div class="step-num">4</div><h4>Compete & Learn</h4><p>See results, analyze market research, refine strategy</p></div>
  </div>
</section>

<section class="segments">
  <h2>Target Your Market</h2>
  <div class="seg-grid">
    <div class="seg-card"><div class="seg-emoji">üíº</div><h4>Worker</h4><p>Daily commuters wanting reliability & comfort</p></div>
    <div class="seg-card"><div class="seg-emoji">üåø</div><h4>Recreation</h4><p>Weekend riders seeking fun & style</p></div>
    <div class="seg-card"><div class="seg-emoji">üßí</div><h4>Youth</h4><p>Young riders, price-sensitive, durability matters</p></div>
    <div class="seg-card"><div class="seg-emoji">‚õ∞Ô∏è</div><h4>Mountain</h4><p>Performance-driven off-road enthusiasts</p></div>
    <div class="seg-card"><div class="seg-emoji">‚ö°</div><h4>Speed</h4><p>Competitive cyclists demanding top performance</p></div>
  </div>
</section>

<footer>¬© 2026 MarketSim Live ‚Äî Marketing Simulation Platform</footer>

<!-- Login Modal -->
<div class="modal-overlay" id="loginModal">
  <div class="modal">
    <h2>Welcome Back</h2>
    <div class="alert alert-error" id="loginError"></div>
    <div class="form-group"><label>Email</label><input type="email" id="loginEmail"></div>
    <div class="form-group"><label>Password</label><input type="password" id="loginPassword"></div>
    <button class="btn btn-primary" style="width:100%" onclick="doLogin()">Log In</button>
    <div class="divider">or</div>
    <button class="btn-google" onclick="googleAuth()">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 01-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"/><path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18A10.96 10.96 0 001 12c0 1.77.42 3.45 1.18 4.93l3.66-2.84z"/><path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
      Continue with Google
    </button>
    <div class="modal-footer">
      <a href="#" onclick="showModal('register');return false">Create account</a>
      <a href="#" onclick="showModal('forgot');return false">Forgot password?</a>
    </div>
  </div>
</div>

<!-- Register Modal -->
<div class="modal-overlay" id="registerModal">
  <div class="modal">
    <h2>Create Account</h2>
    <div class="alert alert-error" id="registerError"></div>
    <div class="form-group"><label>Full Name</label><input type="text" id="regName"></div>
    <div class="form-group"><label>Email</label><input type="email" id="regEmail"></div>
    <div class="form-group"><label>Password (min 8 chars)</label><input type="password" id="regPassword"></div>
    <div class="form-group">
      <label>Role</label>
      <select id="regRole"><option value="student">Student</option><option value="instructor">Instructor</option></select>
    </div>
    <button class="btn btn-primary" style="width:100%" onclick="doRegister()">Create Account</button>
    <div class="divider">or</div>
    <button class="btn-google" onclick="googleAuth()">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 01-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"/><path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18A10.96 10.96 0 001 12c0 1.77.42 3.45 1.18 4.93l3.66-2.84z"/><path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
      Continue with Google
    </button>
    <div class="modal-footer"><a href="#" onclick="showModal('login');return false">Already have an account? Log in</a></div>
  </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal-overlay" id="forgotModal">
  <div class="modal">
    <h2>Reset Password</h2>
    <div class="alert alert-error" id="forgotError"></div>
    <div class="alert alert-success" id="forgotSuccess"></div>
    <div class="form-group"><label>Email</label><input type="email" id="forgotEmail"></div>
    <button class="btn btn-primary" style="width:100%" onclick="doForgot()">Send Reset Link</button>
    <div class="modal-footer"><a href="#" onclick="showModal('login');return false">Back to login</a></div>
  </div>
</div>

<!-- Join Game Modal -->
<div class="modal-overlay" id="joinModal">
  <div class="modal">
    <h2>Join a Game</h2>
    <div class="alert alert-error" id="joinError"></div>
    <div class="alert alert-success" id="joinSuccess"></div>
    <p style="color:var(--muted);font-size:.9rem;margin-bottom:16px">Enter the game code from your instructor</p>
    <div class="form-group">
      <label>Game Code</label>
      <div class="join-input">
        <input type="text" id="joinCode" placeholder="e.g. MKT-ABC123" style="text-transform:uppercase">
        <button class="btn btn-primary" onclick="doJoinGame()">Join</button>
      </div>
    </div>
    <div class="form-group"><label>Team Name (or leave blank to auto-assign)</label><input type="text" id="joinTeam" placeholder="Optional"></div>
    <div class="modal-footer"><a href="#" onclick="closeModals();return false">Cancel</a></div>
  </div>
</div>

<script>
const API=window.location.origin;
let currentUser=null;

function showModal(id){closeModals();document.getElementById(id+'Modal').classList.add('active')}
function closeModals(){document.querySelectorAll('.modal-overlay').forEach(m=>m.classList.remove('active'))}
document.querySelectorAll('.modal-overlay').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)closeModals()}));

function showError(id,msg){const el=document.getElementById(id);el.textContent=msg;el.style.display='block'}
function hideAlerts(){document.querySelectorAll('.alert').forEach(a=>a.style.display='none')}

async function apiFetch(url,opts={}){
  const token=localStorage.getItem('token');
  const headers={'Content-Type':'application/json',...(opts.headers||{})};
  if(token)headers['Authorization']='Bearer '+token;
  try{
    const res=await fetch(API+url,{...opts,headers});
    const text=await res.text();
    try{return JSON.parse(text)}catch(e){console.error('Non-JSON response from '+url+':',text);return{error:'Server error ‚Äî please try again'}}
  }catch(e){console.error('Network error for '+url+':',e);return{error:'Network error ‚Äî please check your connection'}}
}

async function doLogin(){
  hideAlerts();
  const email=document.getElementById('loginEmail').value;
  const password=document.getElementById('loginPassword').value;
  if(!email||!password)return showError('loginError','Please fill in all fields');
  try{
    const data=await apiFetch('/api/auth/login',{method:'POST',body:JSON.stringify({email,password})});
    if(data.error)return showError('loginError',data.error);
    if(!data.token){console.error('No token in login response:',data);return showError('loginError','Login failed ‚Äî please try again')}
    localStorage.setItem('token',data.token);
    currentUser=data.user;
    closeModals();
    updateNav();
    goToDashboard();
  }catch(e){console.error('Login error:',e);showError('loginError','Something went wrong ‚Äî please try again')}
}

async function doRegister(){
  hideAlerts();
  const name=document.getElementById('regName').value;
  const email=document.getElementById('regEmail').value;
  const password=document.getElementById('regPassword').value;
  const role=document.getElementById('regRole').value;
  if(!name||!email||!password)return showError('registerError','Please fill in all fields');
  try{
    const data=await apiFetch('/api/auth/register',{method:'POST',body:JSON.stringify({name,email,password,is_instructor:role==='instructor'})});
    if(data.error)return showError('registerError',data.error);
    if(!data.token){console.error('No token in register response:',data);return showError('registerError','Registration failed ‚Äî please try again')}
    localStorage.setItem('token',data.token);
    currentUser=data.user;
    closeModals();
    updateNav();
    goToDashboard();
  }catch(e){console.error('Register error:',e);showError('registerError','Something went wrong ‚Äî please try again')}
}

async function doForgot(){
  hideAlerts();
  const email=document.getElementById('forgotEmail').value;
  if(!email)return showError('forgotError','Please enter your email');
  const data=await apiFetch('/api/auth/forgot-password',{method:'POST',body:JSON.stringify({email})});
  if(data.error)return showError('forgotError',data.error);
  const el=document.getElementById('forgotSuccess');el.textContent='Reset link sent! Check your email.';el.style.display='block';
}

async function doJoinGame(){
  hideAlerts();
  const token=localStorage.getItem('token');
  if(!token)return showModal('login');
  const code=document.getElementById('joinCode').value.trim().toUpperCase();
  const teamName=document.getElementById('joinTeam').value.trim();
  if(!code)return showError('joinError','Please enter a game code');
  const data=await apiFetch('/api/game/join',{method:'POST',body:JSON.stringify({code,team_name:teamName||undefined})});
  if(data.error)return showError('joinError',data.error);
  const el=document.getElementById('joinSuccess');el.textContent='Joined! Redirecting...';el.style.display='block';
  setTimeout(()=>window.location.href='/dashboard.html',1000);
}

function googleAuth(){window.location.href=API+'/api/auth/google'}

function goToDashboard(){window.location.href='/dashboard.html'}

function logout(){localStorage.removeItem('token');currentUser=null;updateNav()}

function updateNav(){
  if(currentUser){
    document.getElementById('navLinks').style.display='none';
    document.getElementById('navUser').style.display='flex';
    document.getElementById('navUserName').textContent=currentUser.name;
  } else {
    document.getElementById('navLinks').style.display='flex';
    document.getElementById('navUser').style.display='none';
  }
}

async function checkAuth(){
  const token=localStorage.getItem('token');
  if(!token)return;
  const data=await apiFetch('/api/auth/me');
  if(data.user){currentUser=data.user;updateNav()}
  else localStorage.removeItem('token');
}

checkAuth();
</script>
</body>
</html>
